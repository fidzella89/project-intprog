{"ast":null,"code":"import { first } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@app/_services\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/router\";\nfunction ListComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelement(1, \"span\", 7);\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ListComponent_table_3_tr_11_span_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 20);\n  }\n}\nfunction ListComponent_table_3_tr_11_span_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Delete\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ListComponent_table_3_tr_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"span\", 15);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\", 16)(9, \"a\", 17);\n    i0.ɵɵtext(10, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function ListComponent_table_3_tr_11_Template_button_click_11_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const department_r6 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r9.openDeleteModal(department_r6));\n    });\n    i0.ɵɵtemplate(12, ListComponent_table_3_tr_11_span_12_Template, 1, 0, \"span\", 19);\n    i0.ɵɵtemplate(13, ListComponent_table_3_tr_11_span_13_Template, 2, 0, \"span\", 14);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const department_r6 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(department_r6.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(department_r6.description);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", department_r6.employeeCount || 0, \" Employee(s) \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"edit/\", department_r6.id, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", department_r6.isDeleting);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", department_r6.isDeleting);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !department_r6.isDeleting);\n  }\n}\nfunction ListComponent_table_3_tr_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 21)(2, \"span\", 22);\n    i0.ɵɵtext(3, \"No departments found\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction ListComponent_table_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"table\", 8)(1, \"thead\")(2, \"tr\")(3, \"th\", 9);\n    i0.ɵɵtext(4, \"Name\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"th\", 10);\n    i0.ɵɵtext(6, \"Description\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"th\", 11);\n    i0.ɵɵtext(8, \"Employee Count\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(9, \"th\", 12);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(10, \"tbody\");\n    i0.ɵɵtemplate(11, ListComponent_table_3_tr_11_Template, 14, 7, \"tr\", 13);\n    i0.ɵɵtemplate(12, ListComponent_table_3_tr_12_Template, 4, 0, \"tr\", 14);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.departments);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.departments.length === 0);\n  }\n}\nfunction ListComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 23);\n  }\n}\nfunction ListComponent_div_5_span_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"span\", 36);\n  }\n}\nfunction ListComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"div\", 25)(2, \"div\", 26)(3, \"div\", 27)(4, \"h5\", 28);\n    i0.ɵɵtext(5, \"Confirm Deletion\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"button\", 29);\n    i0.ɵɵlistener(\"click\", function ListComponent_div_5_Template_button_click_6_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.closeDeleteModal());\n    });\n    i0.ɵɵtext(7, \"\\u00D7\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"div\", 30)(9, \"p\");\n    i0.ɵɵtext(10, \"Are you sure you want to delete the department \");\n    i0.ɵɵelementStart(11, \"strong\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(13, \"?\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"p\", 31);\n    i0.ɵɵtext(15, \"This action cannot be undone.\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"p\");\n    i0.ɵɵtext(17, \"If employees are assigned to this department, they will need to be reassigned.\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(18, \"div\", 32)(19, \"button\", 33);\n    i0.ɵɵlistener(\"click\", function ListComponent_div_5_Template_button_click_19_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r14.closeDeleteModal());\n    });\n    i0.ɵɵtext(20, \"Cancel\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(21, \"button\", 34);\n    i0.ɵɵlistener(\"click\", function ListComponent_div_5_Template_button_click_21_listener() {\n      i0.ɵɵrestoreView(_r13);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.confirmDelete());\n    });\n    i0.ɵɵtemplate(22, ListComponent_div_5_span_22_Template, 1, 0, \"span\", 35);\n    i0.ɵɵtext(23, \" Confirm Delete \");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(12);\n    i0.ɵɵtextInterpolate(ctx_r3.departmentToDelete == null ? null : ctx_r3.departmentToDelete.name);\n    i0.ɵɵadvance(9);\n    i0.ɵɵproperty(\"disabled\", ctx_r3.departmentToDelete == null ? null : ctx_r3.departmentToDelete.isDeleting);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.departmentToDelete == null ? null : ctx_r3.departmentToDelete.isDeleting);\n  }\n}\nexport let ListComponent = /*#__PURE__*/(() => {\n  class ListComponent {\n    constructor(departmentService, employeeService, alertService) {\n      this.departmentService = departmentService;\n      this.employeeService = employeeService;\n      this.alertService = alertService;\n      this.departments = [];\n      this.departmentToDelete = null;\n      this.showDeleteModal = false;\n    }\n    ngOnInit() {\n      this.loadDepartmentsWithEmployeeCounts();\n    }\n    loadDepartmentsWithEmployeeCounts() {\n      // First load all departments\n      this.departmentService.getAll().pipe(first()).subscribe(departments => {\n        this.departments = departments;\n        // Then load all employees to count department assignments\n        this.employeeService.getAll().pipe(first()).subscribe(employees => {\n          // Calculate employee count for each department\n          this.departments.forEach(dept => {\n            dept.employeeCount = employees.filter(emp => emp.departmentId.toString() === dept.id.toString()).length;\n          });\n        });\n      });\n    }\n    openDeleteModal(department) {\n      this.departmentToDelete = department;\n      this.showDeleteModal = true;\n      document.body.classList.add('modal-open');\n    }\n    confirmDelete() {\n      if (!this.departmentToDelete) return;\n      const department = this.departmentToDelete;\n      department.isDeleting = true;\n      this.departmentService.delete(department.id).pipe(first()).subscribe({\n        next: () => {\n          this.departments = this.departments.filter(x => x.id !== department.id);\n          this.alertService.success('Department deleted successfully');\n          this.closeDeleteModal();\n        },\n        error: error => {\n          this.alertService.error(error);\n          department.isDeleting = false;\n          this.closeDeleteModal();\n        }\n      });\n    }\n    closeDeleteModal() {\n      this.showDeleteModal = false;\n      document.body.classList.remove('modal-open');\n      this.departmentToDelete = null;\n    }\n  }\n  ListComponent.ɵfac = function ListComponent_Factory(t) {\n    return new (t || ListComponent)(i0.ɵɵdirectiveInject(i1.DepartmentService), i0.ɵɵdirectiveInject(i1.EmployeeService), i0.ɵɵdirectiveInject(i1.AlertService));\n  };\n  ListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ListComponent,\n    selectors: [[\"ng-component\"]],\n    decls: 6,\n    vars: 4,\n    consts: [[1, \"card\"], [1, \"card-body\"], [\"class\", \"text-center\", 4, \"ngIf\"], [\"class\", \"table table-striped\", 4, \"ngIf\"], [\"class\", \"modal-backdrop\", 4, \"ngIf\"], [\"class\", \"modal\", 4, \"ngIf\"], [1, \"text-center\"], [1, \"spinner-border\", \"spinner-border-lg\", \"align-center\"], [1, \"table\", \"table-striped\"], [2, \"width\", \"25%\"], [2, \"width\", \"40%\"], [2, \"width\", \"15%\"], [2, \"width\", \"20%\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"badge\", \"bg-info\"], [2, \"white-space\", \"nowrap\"], [1, \"btn\", \"btn-sm\", \"btn-primary\", \"me-1\", 3, \"routerLink\"], [1, \"btn\", \"btn-sm\", \"btn-danger\", \"btn-delete-department\", 3, \"disabled\", \"click\"], [\"class\", \"spinner-border spinner-border-sm\", 4, \"ngIf\"], [1, \"spinner-border\", \"spinner-border-sm\"], [\"colspan\", \"4\", 1, \"text-center\"], [1, \"text-muted\"], [1, \"modal-backdrop\"], [1, \"modal\"], [1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-title\"], [\"type\", \"button\", \"aria-label\", \"Close\", 1, \"btn-close\", 3, \"click\"], [1, \"modal-body\"], [1, \"text-danger\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [\"type\", \"button\", 1, \"btn\", \"btn-danger\", 3, \"disabled\", \"click\"], [\"class\", \"spinner-border spinner-border-sm me-1\", 4, \"ngIf\"], [1, \"spinner-border\", \"spinner-border-sm\", \"me-1\"]],\n    template: function ListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n        i0.ɵɵtemplate(2, ListComponent_div_2_Template, 2, 0, \"div\", 2);\n        i0.ɵɵtemplate(3, ListComponent_table_3_Template, 13, 2, \"table\", 3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(4, ListComponent_div_4_Template, 1, 0, \"div\", 4);\n        i0.ɵɵtemplate(5, ListComponent_div_5_Template, 24, 3, \"div\", 5);\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", !ctx.departments);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.departments);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showDeleteModal);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.showDeleteModal);\n      }\n    },\n    dependencies: [i2.NgForOf, i2.NgIf, i3.RouterLink],\n    styles: [\".modal-backdrop[_ngcontent-%COMP%] {\\n            position: fixed;\\n            top: 0;\\n            left: 0;\\n            width: 100%;\\n            height: 100%;\\n            background-color: rgba(0, 0, 0, 0.5);\\n            z-index: 1040;\\n        }\\n        .modal[_ngcontent-%COMP%] {\\n            position: fixed;\\n            top: 0;\\n            left: 0;\\n            width: 100%;\\n            height: 100%;\\n            z-index: 1050;\\n            overflow: auto;\\n            display: flex;\\n            align-items: center;\\n            justify-content: center;\\n        }\\n        .modal-dialog[_ngcontent-%COMP%] {\\n            width: 100%;\\n            max-width: 500px;\\n            margin: 1.75rem auto;\\n            position: relative;\\n        }\\n        .modal-content[_ngcontent-%COMP%] {\\n            position: relative;\\n            background-color: #fff;\\n            border-radius: 0.3rem;\\n            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.5);\\n        }\\n        .modal-header[_ngcontent-%COMP%] {\\n            display: flex;\\n            align-items: center;\\n            justify-content: space-between;\\n            padding: 1rem;\\n            background-color: #f8f9fa;\\n            border-bottom: 1px solid #e9ecef;\\n            border-top-left-radius: 0.3rem;\\n            border-top-right-radius: 0.3rem;\\n        }\\n        .modal-body[_ngcontent-%COMP%] {\\n            padding: 1rem;\\n        }\\n        .modal-footer[_ngcontent-%COMP%] {\\n            display: flex;\\n            align-items: center;\\n            justify-content: flex-end;\\n            padding: 1rem;\\n            border-top: 1px solid #e9ecef;\\n        }\\n        .btn-close[_ngcontent-%COMP%] {\\n            background: transparent;\\n            border: 0;\\n            font-size: 1.5rem;\\n            font-weight: 700;\\n            color: #000;\\n            opacity: 0.5;\\n            cursor: pointer;\\n        }\\n        .show[_ngcontent-%COMP%] {\\n            display: flex !important;\\n        }\\n        .hide[_ngcontent-%COMP%] {\\n            display: none !important;\\n        }\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZGVwYXJ0bWVudHMvbGlzdC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtRQUNRO1lBQ0ksZUFBZTtZQUNmLE1BQU07WUFDTixPQUFPO1lBQ1AsV0FBVztZQUNYLFlBQVk7WUFDWixvQ0FBb0M7WUFDcEMsYUFBYTtRQUNqQjtRQUNBO1lBQ0ksZUFBZTtZQUNmLE1BQU07WUFDTixPQUFPO1lBQ1AsV0FBVztZQUNYLFlBQVk7WUFDWixhQUFhO1lBQ2IsY0FBYztZQUNkLGFBQWE7WUFDYixtQkFBbUI7WUFDbkIsdUJBQXVCO1FBQzNCO1FBQ0E7WUFDSSxXQUFXO1lBQ1gsZ0JBQWdCO1lBQ2hCLG9CQUFvQjtZQUNwQixrQkFBa0I7UUFDdEI7UUFDQTtZQUNJLGtCQUFrQjtZQUNsQixzQkFBc0I7WUFDdEIscUJBQXFCO1lBQ3JCLDRDQUE0QztRQUNoRDtRQUNBO1lBQ0ksYUFBYTtZQUNiLG1CQUFtQjtZQUNuQiw4QkFBOEI7WUFDOUIsYUFBYTtZQUNiLHlCQUF5QjtZQUN6QixnQ0FBZ0M7WUFDaEMsOEJBQThCO1lBQzlCLCtCQUErQjtRQUNuQztRQUNBO1lBQ0ksYUFBYTtRQUNqQjtRQUNBO1lBQ0ksYUFBYTtZQUNiLG1CQUFtQjtZQUNuQix5QkFBeUI7WUFDekIsYUFBYTtZQUNiLDZCQUE2QjtRQUNqQztRQUNBO1lBQ0ksdUJBQXVCO1lBQ3ZCLFNBQVM7WUFDVCxpQkFBaUI7WUFDakIsZ0JBQWdCO1lBQ2hCLFdBQVc7WUFDWCxZQUFZO1lBQ1osZUFBZTtRQUNuQjtRQUNBO1lBQ0ksd0JBQXdCO1FBQzVCO1FBQ0E7WUFDSSx3QkFBd0I7UUFDNUIiLCJzb3VyY2VzQ29udGVudCI6WyJcbiAgICAgICAgLm1vZGFsLWJhY2tkcm9wIHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgIHRvcDogMDtcbiAgICAgICAgICAgIGxlZnQ6IDA7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwNDA7XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsIHtcbiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICAgICAgICAgIHRvcDogMDtcbiAgICAgICAgICAgIGxlZnQ6IDA7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgICAgICAgIHotaW5kZXg6IDEwNTA7XG4gICAgICAgICAgICBvdmVyZmxvdzogYXV0bztcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyO1xuICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsLWRpYWxvZyB7XG4gICAgICAgICAgICB3aWR0aDogMTAwJTtcbiAgICAgICAgICAgIG1heC13aWR0aDogNTAwcHg7XG4gICAgICAgICAgICBtYXJnaW46IDEuNzVyZW0gYXV0bztcbiAgICAgICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgICAgfVxuICAgICAgICAubW9kYWwtY29udGVudCB7XG4gICAgICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xuICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMC4zcmVtO1xuICAgICAgICAgICAgYm94LXNoYWRvdzogMCAwLjVyZW0gMXJlbSByZ2JhKDAsIDAsIDAsIDAuNSk7XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsLWhlYWRlciB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgICAgICAgICAgIHBhZGRpbmc6IDFyZW07XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmOWZhO1xuICAgICAgICAgICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlOWVjZWY7XG4gICAgICAgICAgICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiAwLjNyZW07XG4gICAgICAgICAgICBib3JkZXItdG9wLXJpZ2h0LXJhZGl1czogMC4zcmVtO1xuICAgICAgICB9XG4gICAgICAgIC5tb2RhbC1ib2R5IHtcbiAgICAgICAgICAgIHBhZGRpbmc6IDFyZW07XG4gICAgICAgIH1cbiAgICAgICAgLm1vZGFsLWZvb3RlciB7XG4gICAgICAgICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7XG4gICAgICAgICAgICBwYWRkaW5nOiAxcmVtO1xuICAgICAgICAgICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNlOWVjZWY7XG4gICAgICAgIH1cbiAgICAgICAgLmJ0bi1jbG9zZSB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbiAgICAgICAgICAgIGJvcmRlcjogMDtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMS41cmVtO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDcwMDtcbiAgICAgICAgICAgIGNvbG9yOiAjMDAwO1xuICAgICAgICAgICAgb3BhY2l0eTogMC41O1xuICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyO1xuICAgICAgICB9XG4gICAgICAgIC5zaG93IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXggIWltcG9ydGFudDtcbiAgICAgICAgfVxuICAgICAgICAuaGlkZSB7XG4gICAgICAgICAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7XG4gICAgICAgIH1cbiAgICAiXSwic291cmNlUm9vdCI6IiJ9 */\"]\n  });\n  return ListComponent;\n})();","map":{"version":3,"mappings":"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","names":["first","i0","ListComponent","constructor","departmentService","employeeService","alertService","ngOnInit","loadDepartmentsWithEmployeeCounts","getAll","pipe","subscribe","departments","employees","forEach","dept","employeeCount","filter","emp","departmentId","toString","id","length","openDeleteModal","department","departmentToDelete","showDeleteModal","document","body","classList","add","confirmDelete","isDeleting","delete","next","x","success","closeDeleteModal","error","remove","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["D:\\JiM\\School\\3rd Year\\2nd Semester\\SUBJECTS\\IT-INTPROG32\\Coding (INTPROG32)\\Final\\project6\\frontend\\src\\app\\departments\\list.component.ts","D:\\JiM\\School\\3rd Year\\2nd Semester\\SUBJECTS\\IT-INTPROG32\\Coding (INTPROG32)\\Final\\project6\\frontend\\src\\app\\departments\\list.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { first } from 'rxjs/operators';\r\n\r\nimport { DepartmentService, AlertService, EmployeeService } from '@app/_services';\r\nimport { Department } from '@app/_models';\r\n\r\n@Component({ \r\n    templateUrl: 'list.component.html',\r\n    styles: [`\r\n        .modal-backdrop {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            background-color: rgba(0, 0, 0, 0.5);\r\n            z-index: 1040;\r\n        }\r\n        .modal {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            width: 100%;\r\n            height: 100%;\r\n            z-index: 1050;\r\n            overflow: auto;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n        }\r\n        .modal-dialog {\r\n            width: 100%;\r\n            max-width: 500px;\r\n            margin: 1.75rem auto;\r\n            position: relative;\r\n        }\r\n        .modal-content {\r\n            position: relative;\r\n            background-color: #fff;\r\n            border-radius: 0.3rem;\r\n            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.5);\r\n        }\r\n        .modal-header {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: space-between;\r\n            padding: 1rem;\r\n            background-color: #f8f9fa;\r\n            border-bottom: 1px solid #e9ecef;\r\n            border-top-left-radius: 0.3rem;\r\n            border-top-right-radius: 0.3rem;\r\n        }\r\n        .modal-body {\r\n            padding: 1rem;\r\n        }\r\n        .modal-footer {\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: flex-end;\r\n            padding: 1rem;\r\n            border-top: 1px solid #e9ecef;\r\n        }\r\n        .btn-close {\r\n            background: transparent;\r\n            border: 0;\r\n            font-size: 1.5rem;\r\n            font-weight: 700;\r\n            color: #000;\r\n            opacity: 0.5;\r\n            cursor: pointer;\r\n        }\r\n        .show {\r\n            display: flex !important;\r\n        }\r\n        .hide {\r\n            display: none !important;\r\n        }\r\n    `]\r\n})\r\nexport class ListComponent implements OnInit {\r\n    departments: Department[] = [];\r\n    departmentToDelete = null;\r\n    showDeleteModal = false;\r\n\r\n    constructor(\r\n        private departmentService: DepartmentService,\r\n        private employeeService: EmployeeService,\r\n        private alertService: AlertService\r\n    ) {}\r\n\r\n    ngOnInit() {\r\n        this.loadDepartmentsWithEmployeeCounts();\r\n    }\r\n\r\n    private loadDepartmentsWithEmployeeCounts() {\r\n        // First load all departments\r\n        this.departmentService.getAll()\r\n            .pipe(first())\r\n            .subscribe(departments => {\r\n                this.departments = departments;\r\n                \r\n                // Then load all employees to count department assignments\r\n                this.employeeService.getAll()\r\n                    .pipe(first())\r\n                    .subscribe(employees => {\r\n                        // Calculate employee count for each department\r\n                        this.departments.forEach(dept => {\r\n                            dept.employeeCount = employees.filter(emp => \r\n                                emp.departmentId.toString() === dept.id.toString()\r\n                            ).length;\r\n                        });\r\n                    });\r\n            });\r\n    }\r\n\r\n    openDeleteModal(department) {\r\n        this.departmentToDelete = department;\r\n        this.showDeleteModal = true;\r\n        document.body.classList.add('modal-open');\r\n    }\r\n\r\n    confirmDelete() {\r\n        if (!this.departmentToDelete) return;\r\n        \r\n        const department = this.departmentToDelete;\r\n        department.isDeleting = true;\r\n\r\n        this.departmentService.delete(department.id)\r\n            .pipe(first())\r\n            .subscribe({\r\n                next: () => {\r\n                    this.departments = this.departments.filter(x => x.id !== department.id);\r\n                    this.alertService.success('Department deleted successfully');\r\n                    this.closeDeleteModal();\r\n                },\r\n                error: error => {\r\n                    this.alertService.error(error);\r\n                    department.isDeleting = false;\r\n                    this.closeDeleteModal();\r\n                }\r\n            });\r\n    }\r\n\r\n    closeDeleteModal() {\r\n        this.showDeleteModal = false;\r\n        document.body.classList.remove('modal-open');\r\n        this.departmentToDelete = null;\r\n    }\r\n} ","<div class=\"card\">\r\n    <div class=\"card-body\">\r\n        <div *ngIf=\"!departments\" class=\"text-center\">\r\n            <span class=\"spinner-border spinner-border-lg align-center\"></span>\r\n        </div>\r\n        <table *ngIf=\"departments\" class=\"table table-striped\">\r\n            <thead>\r\n                <tr>\r\n                    <th style=\"width: 25%\">Name</th>\r\n                    <th style=\"width: 40%\">Description</th>\r\n                    <th style=\"width: 15%\">Employee Count</th>\r\n                    <th style=\"width: 20%\"></th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                <tr *ngFor=\"let department of departments\">\r\n                    <td>{{department.name}}</td>\r\n                    <td>{{department.description}}</td>\r\n                    <td>\r\n                        <span class=\"badge bg-info\">\r\n                            {{department.employeeCount || 0}} Employee(s)\r\n                        </span>\r\n                    </td>\r\n                    <td style=\"white-space: nowrap\">\r\n                        <a routerLink=\"edit/{{department.id}}\" class=\"btn btn-sm btn-primary me-1\">Edit</a>\r\n                        <button (click)=\"openDeleteModal(department)\" class=\"btn btn-sm btn-danger btn-delete-department\"\r\n                            [disabled]=\"department.isDeleting\">\r\n                            <span *ngIf=\"department.isDeleting\" class=\"spinner-border spinner-border-sm\"></span>\r\n                            <span *ngIf=\"!department.isDeleting\">Delete</span>\r\n                        </button>\r\n                    </td>\r\n                </tr>\r\n                <tr *ngIf=\"departments.length === 0\">\r\n                    <td colspan=\"4\" class=\"text-center\">\r\n                        <span class=\"text-muted\">No departments found</span>\r\n                    </td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n</div>\r\n\r\n<!-- Delete Confirmation Modal -->\r\n<div *ngIf=\"showDeleteModal\" class=\"modal-backdrop\"></div>\r\n<div *ngIf=\"showDeleteModal\" class=\"modal\">\r\n    <div class=\"modal-dialog\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h5 class=\"modal-title\">Confirm Deletion</h5>\r\n                <button type=\"button\" class=\"btn-close\" (click)=\"closeDeleteModal()\" aria-label=\"Close\">&times;</button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <p>Are you sure you want to delete the department <strong>{{departmentToDelete?.name}}</strong>?</p>\r\n                <p class=\"text-danger\">This action cannot be undone.</p>\r\n                <p>If employees are assigned to this department, they will need to be reassigned.</p>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" (click)=\"closeDeleteModal()\">Cancel</button>\r\n                <button type=\"button\" class=\"btn btn-danger\" (click)=\"confirmDelete()\" \r\n                    [disabled]=\"departmentToDelete?.isDeleting\">\r\n                    <span *ngIf=\"departmentToDelete?.isDeleting\" class=\"spinner-border spinner-border-sm me-1\"></span>\r\n                    Confirm Delete\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div> "]},"metadata":{},"sourceType":"module","externalDependencies":[]}